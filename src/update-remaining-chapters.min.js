const fs=require('fs');const path=require('path');const filesToUpdate=['chapter2.html','chapter3.html','chapter4.html','chapter6.html','chapter7.html','chapter8.html','chapter9.html','chapter10.html','chapter11.html','chapter12.html','chapter13.html','chapter14.html','chapters.html','timeline.html','symbols.html','enhanced-chapter4.html','enhanced-chapter5.html','enhanced-chapter6.html','enhanced-chapter7.html','enhanced-chapter8.html','enhanced-chapter9.html','enhanced-chapter10.html','enhanced-chapter11.html','enhanced-chapters.html'];const phase3CSS=`<!--Phase 3 Enhancements--><link rel="stylesheet" href="css/styles-v3.css">`;const phase3Scripts=`<!--Phase 3 Scripts--><script src="js/advanced-animations.js"></script><script src="js/gesture-controller.js"></script><script src="js/contextual-help.js"></script><script src="js/keyboard-shortcuts.js"></script><script src="js/smart-asset-loader.js"></script><script src="js/adaptive-quality.js"></script><script src="js/learning-analytics.js"></script><script src="js/production-error-handler.js"></script><script>document.addEventListener('DOMContentLoaded',async()=>{window.errorHandler=new ProductionErrorHandler();window.adaptiveQuality=new AdaptiveQuality();if('ontouchstart' in window){window.gestureController=new GestureController(document.body);}window.keyboardShortcuts=new KeyboardShortcuts();window.contextualHelp=new ContextualHelp();window.advancedAnimations=new AdvancedAnimations();window.assetLoader=new SmartAssetLoader();window.learningAnalytics=new LearningAnalytics();if(window.learningAnalytics){window.learningAnalytics.trackPageView();}});</script>`;let updatedCount=0;let skippedCount=0;let errorCount=0;filesToUpdate.forEach(fileName=>{try{const filePath=path.join(__dirname,fileName);if(!fs.existsSync(filePath)){skippedCount++;return;}let content=fs.readFileSync(filePath,'utf8');if(content.includes('styles-v3.css')){skippedCount++;return;}const cssPattern=/<link rel="stylesheet" href="styles-v3\.css">/;if(cssPattern.test(content)){content=content.replace(cssPattern,`<link rel="stylesheet" href="styles-v3.css">\n${phase3CSS}`);}else{const altCssPattern=/(<\/head>)/;if(altCssPattern.test(content)){content=content.replace(altCssPattern,`${phase3CSS}\n$1`);}}const bodyPattern=/(\s*<\/body>)/;if(bodyPattern.test(content)){content=content.replace(bodyPattern,`${phase3Scripts}\n$1`);}fs.writeFileSync(filePath,content,'utf8');updatedCount++;}catch(error){console.error(`‚ùå Error updating ${fileName}:`,error.message);errorCount++;}});